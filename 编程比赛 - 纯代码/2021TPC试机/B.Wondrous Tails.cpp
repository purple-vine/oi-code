#include <iostream>
#include <cstdio>
using namespace std;
bool a[24][4][4]={1,1,1,1,1,0,1,0,1,1,0,0,1,0,0,0,
1,1,1,1,0,1,1,0,0,1,0,0,1,1,0,0,
1,1,1,1,0,1,1,0,0,0,1,0,0,0,1,1,
1,1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,
1,1,1,1,0,1,0,0,0,1,1,0,0,1,0,1,
1,1,1,1,0,0,1,0,0,1,1,0,1,0,1,0,
1,1,0,0,0,1,0,0,1,1,1,1,0,1,0,1,
1,1,0,0,0,1,0,0,0,1,1,0,1,1,1,1,
1,0,1,0,1,1,1,1,0,0,1,0,0,0,1,1,
1,0,1,0,0,1,1,0,0,0,1,0,1,1,1,1,
1,0,0,1,1,1,1,1,1,1,0,0,1,0,0,0,
1,0,0,1,1,1,1,1,0,0,1,1,0,0,0,1,
1,0,0,1,1,0,1,0,1,1,1,1,1,0,0,0,
1,0,0,1,0,1,0,1,1,1,1,1,0,0,0,1,
1,0,0,0,1,1,1,1,1,0,1,0,1,0,0,1,
1,0,0,0,1,1,0,0,1,1,1,1,1,0,0,1,
1,0,0,0,1,1,0,0,1,0,1,0,1,1,1,1,
0,1,0,1,1,1,1,1,0,1,0,0,1,1,0,0,
0,1,0,1,0,1,1,0,0,1,0,0,1,1,1,1,
0,0,1,1,0,0,1,0,1,1,1,1,1,0,1,0,
0,0,1,1,0,0,1,0,0,1,1,0,1,1,1,1,
0,0,0,1,1,1,1,1,0,1,0,1,1,0,0,1,
0,0,0,1,0,0,1,1,1,1,1,1,1,0,0,1,
0,0,0,1,0,0,1,1,0,1,0,1,1,1,1,1};
bool s[4][4];
int t,cnt;
int minn=16;
int main(){
	scanf("%d",&t);
	while(t--){
		char c=getchar();
		for(int i=0;i<4;i++){
			for(int j=0;j<4;j++){
				c=getchar();
				if(c=='#') s[i][j]=1;
				else s[i][j]=0;
			}
			if(i<3) c=getchar();
		}
		/*for(int i=0;i<4;i++){
			for(int j=0;j<4;j++) cout << s[i][j];
			cout << endl;
		}*/
		for(int k=0;k<24;k++){
			cnt=0;
			for(int i=0;i<4;i++){
				for(int j=0;j<4;j++){
					if(a[k][i][j]!=s[i][j]) cnt++;
				}
			}
			cnt/=2;
			minn=min(cnt,minn);
		}
		printf("%d\n",minn);
		minn=16;
	}
}
